{"componentChunkName":"component---src-templates-post-tsx","path":"/block-requests-with-fiddlercore/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Block requests with FiddlerCore","path":"/block-requests-with-fiddlercore","date":"August 07, 2015","dateIso":"2015-08-07T12:35:00.000Z","tags":["automated-testing","debugging"],"references":["http://docs.telerik.com/fiddler/KnowledgeBase/AutoResponder|Fiddler AutoResponder KB","http://fiddler.wikidot.com/fiddlercore-autorespond|FiddlerCore AutoResponder Wiki"],"description":"Using AutoResponder in FiddlerCore to block requests"},"html":"<p>Fiddler has some really powerful tools for aiding development and assisting with\ndebugging. One of these features is the AutoResponder tab:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 559px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d5475f9d371449129fb1dd7957a26cd4/db7b4/fiddler-autoresponder.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.854166666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHrNakQf//EABgQAQADAQAAAAAAAAAAAAAAAAEAAhMQ/9oACAEBAAEFAs5mStQDv//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAACAgMAAAAAAAAAAAAAAAAAMQEgMpKh/9oACAEBAAY/Al0xnYVP/8QAHBAAAwABBQAAAAAAAAAAAAAAAAERcRAxUZHx/9oACAEBAAE/IYu/uegIBRl0yelfLP/aAAwDAQACAAMAAAAQcx//xAAXEQEAAwAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/EKIx/8QAFxEAAwEAAAAAAAAAAAAAAAAAARARUf/aAAgBAgEBPxCDF//EAB8QAQACAQMFAAAAAAAAAAAAAAEAESFBUZFhccHR8P/aAAgBAQABPxANK3YPM3Po6y9nO6RcstSqZ1Zbu8y33T//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screenshot of Fiddler AutoResponder\"\n        title=\"\"\n        src=\"/static/d5475f9d371449129fb1dd7957a26cd4/db7b4/fiddler-autoresponder.jpg\"\n        srcset=\"/static/d5475f9d371449129fb1dd7957a26cd4/7809d/fiddler-autoresponder.jpg 192w,\n/static/d5475f9d371449129fb1dd7957a26cd4/4ecad/fiddler-autoresponder.jpg 384w,\n/static/d5475f9d371449129fb1dd7957a26cd4/db7b4/fiddler-autoresponder.jpg 559w\"\n        sizes=\"(max-width: 559px) 100vw, 559px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>When writing integration tests, you may need to set up a scenario to test the application\nin a given state based on different responses from external systems. The following class\nshows an example of how you can intercept requests and respond with a 404 response if\nthe request is to a known advertising domain:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BlockTrackingWebsiteRequestsContext</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IEnumerable<span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span> BlockedDomains\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">get</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"flx1.com\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"mmtro.com\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"liverail.com\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"adform.net\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"t.co\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"pubmatic.com\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"doubleclick.net\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">SetupBlockTrackingWebsiteRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        FiddlerApplication<span class=\"token punctuation\">.</span>BeforeRequest <span class=\"token operator\">+=</span> ConfigureBlockTrackingWebsiteRequestsDelegate<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">TearDownBlockTrackingWebsiteRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        FiddlerApplication<span class=\"token punctuation\">.</span>BeforeRequest <span class=\"token operator\">-=</span> ConfigureBlockTrackingWebsiteRequestsDelegate<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ConfigureBlockTrackingWebsiteRequestsDelegate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Session</span> targetSession<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>BlockedDomains<span class=\"token punctuation\">.</span><span class=\"token function\">Any</span><span class=\"token punctuation\">(</span>targetSession<span class=\"token punctuation\">.</span>uriContains<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            targetSession<span class=\"token punctuation\">.</span>oRequest<span class=\"token punctuation\">.</span><span class=\"token function\">FailSession</span><span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Blocked\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Fiddler blacklisted this domain\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To register this functionality within your test, reference this class in the <em>SetUp</em>\nand <em>TearDown</em> methods to your test as follows. It is important to remember to deregister\nthe code at the end of your test so that it doesn't affect any future tests in your test\nfixture.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SetUp</span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">SetUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    BlockTrackingWebsiteRequestsContext<span class=\"token punctuation\">.</span><span class=\"token function\">SetupBlockTrackingWebsiteRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">TearDown</span></span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">TearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    BlockTrackingWebsiteRequestsContext<span class=\"token punctuation\">.</span><span class=\"token function\">TearDownBlockTrackingWebsiteRequests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","timeToRead":1}},"pageContext":{"id":"b9110507-9e8f-5160-9269-2b702e35b5c7"}},"staticQueryHashes":["1942088059"],"slicesMap":{}}