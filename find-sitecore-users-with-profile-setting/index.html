<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Find Sitecore users with profile setting | chowson.github.io</title><meta name="gridsome:hash" content="0c9c7634f9cfa53dc34d0d32389c339688308ca7"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.17"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#2F855A"><meta data-vue-tag="ssr" description="Find Sitecore users with profile setting"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.062b9c780539aa46da100b820dbbfdb3.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.062b9c780539aa46da100b820dbbfdb3.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.062b9c780539aa46da100b820dbbfdb3.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.062b9c780539aa46da100b820dbbfdb3.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Jost:wght@400;700&amp;display=swap"><link rel="preload" href="/assets/css/0.styles.a65170fc.css" as="style"><link rel="preload" href="/assets/js/app.575a9b0d.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.d0e54b0c.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.6fda5675.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.523a4251.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.6b8187ec.js"><link rel="prefetch" href="/assets/js/page--src--pages--tag-vue.686f057d.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.d45ad732.js"><link rel="stylesheet" href="/assets/css/0.styles.a65170fc.css"><script data-vue-tag="ssr" type="application/ld+json">{"@context":"https://schema.org/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://chowson.github.io/find-sitecore-users-with-profile-setting/"},"headline":"headling","author":{"@type":"Person","name":"Chris Howson","sameAs":"https://github.io/chowson"},"publisher":{"@type":"Organization","name":"chowson.github.io","logo":{"@type":"ImageObject","url":"https://chowson.github.io/images/logo.png"}},"image":"https://chowson.github.io/images/logo.png","dateCreated":"2015-06-28","datePublished":"2015-06-28","dateModified":"2015-06-28","description":"Find Sitecore users with profile setting"}</script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script type="text/javascript">
        (function() {
            function setTheme(newTheme) {
                window.__theme = newTheme;
                document.body.setAttribute('data-theme', newTheme);
            }

            var preferredTheme;
            try {
                preferredTheme = localStorage.getItem('theme');
            } catch (err) { }

            window.__setPreferredTheme = function(newTheme) {
                setTheme(newTheme);
                try {
                localStorage.setItem('theme', newTheme);
                } catch (err) {}
            }

            var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

            darkQuery.addListener(function(e) {
                window.__setPreferredTheme(e.matches ? 'theme-dark' : 'theme-light');
            });

            setTheme(preferredTheme || (darkQuery.matches ? 'theme-dark' : 'theme-light'));
        })();
    </script>
    <div data-server-rendered="true" id="app" class="content-wrapper bg-background-primary font-sans text-copy-primary leading-normal flex flex-col min-h-screen"><header class="border-t-14 border-brand-900"><nav class="container mx-auto flex flex-wrap justify-between items-center py-8"><div><a href="/" class="logo flex items-center active"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-terminal"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg><span class="font-bold m-2">chowson.github.io</span></a></div><div class="flex md:hidden"><a href="#" aria-label="Switch theme" class="text-copy-primary hover:text-gray-600 mr-4 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path></svg></a><div class="block"><button name="Open menu" class="flex items-center px-3 py-2 border rounded border-gray-500 hover:text-gray-600 hover:border-gray-600"><svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="current-color h-3 w-3"><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" fill="gray"></path></svg></button></div></div><ul class="uppercase tracking-wide font-bold w-full block flex-grow md:space-x-8 space-y-6 md:space-y-0 md:flex md:flex-initial md:w-auto items-center mt-8 md:mt-0 hidden"><li class="mb-6 md:mb-0"><div class="relative" data-v-023972e7><div data-v-51a16351 data-v-023972e7></div><div class="relative w-80" data-v-023972e7><input type="text" placeholder="Search (Press  "/" to focus)" value="" class="bg-background-form border border-gray-500 rounded-full px-4 pl-10 py-2 outline-none focus:border-brand-500 w-80" data-v-023972e7><div class="absolute top-0 ml-3" style="top:10px" data-v-023972e7><svg fill="currentColor" viewBox="0 0 24 24" width="24" height="24" class="text-gray-500 h-5 w-5" data-v-023972e7><path d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" class="heroicon-ui" data-v-023972e7></path></svg></div><!----></div><!----></div></li><li class="hidden md:block"><a href="#" aria-label="Switch theme" class="text-copy-primary hover:text-gray-600 mr-4 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path></svg></a></li></ul></nav></header><div class="flex-grow"><div class="container-inner mx-auto my-8"><article><h1 class="text-4xl font-bold leading-tight">Find Sitecore users with profile setting</h1><div class="text-xl text-gray-600">July 28, 2015</div><div class="text-sm text-gray-600 mb-4">2 min read</div><div class="flex mb-8 text-sm"><a href="/tag/sitecore/" class="bg-gray-300 rounded-full px-4 py-2 mr-4 text-brand-900 hover:bg-brand-300">
          sitecore
        </a><a href="/tag/sql/" class="bg-gray-300 rounded-full px-4 py-2 mr-4 text-brand-900 hover:bg-brand-300">
          sql
        </a><a href="/tag/debugging/" class="bg-gray-300 rounded-full px-4 py-2 mr-4 text-brand-900 hover:bg-brand-300">
          debugging
        </a></div><div class="markdown-body mb-8"><p>Through the role manager, you can easily find which users are in a particular role but you can't easily
get a list of users which are an administrator. This is because the administrator setting is stored as a
profile value on the user. To generate a list of administrators run the following script against your
<em>core</em> database.</p>
<p>You can also modify the script to find users with the existence of any profile key and optionally users which have a profile key that matches a particular  value. To do this you will need to modify the <em>@propertyKey</em> and <em>@expectedValue</em> variables at the top of the script. Leaving <em>@expectedValue</em> as an empty string will return users which have the existence of a profile key rather than trying to match it to a value.</p>
<pre class="shiki" style="background-color: #2e3440"><code><span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @propertyKey </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> nvarchar(</span><span style="color: #B48EAD">50</span><span style="color: #D8DEE9FF">), @expectedValue </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> nvarchar(</span><span style="color: #B48EAD">255</span><span style="color: #D8DEE9FF">)</span>

<span style="color: #4C566A">--SET PROPERTY KEY AND EXPECTED VALUE HERE</span>
<span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @propertyKey </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">IsAdministrator</span><span style="color: #ECEFF4">'</span>
<span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @expectedValue </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">True</span><span style="color: #ECEFF4">'</span>


<span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @userId </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> uniqueidentifier</span>
<span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @username </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> nvarchar(</span><span style="color: #B48EAD">255</span><span style="color: #D8DEE9FF">)</span>

<span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> userCursor CURSOR </span>
<span style="color: #D8DEE9FF">  LOCAL STATIC READ_ONLY FORWARD_ONLY</span>
<span style="color: #D8DEE9FF">FOR </span>
<span style="color: #81A1C1">SELECT DISTINCT</span><span style="color: #D8DEE9FF"> UserId </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> aspnet_Profile </span><span style="color: #81A1C1">WHERE</span><span style="color: #D8DEE9FF"> PropertyNames </span><span style="color: #81A1C1">LIKE</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">%</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> @propertyKey </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">%</span><span style="color: #ECEFF4">'</span>

<span style="color: #D8DEE9FF">OPEN userCursor</span>
<span style="color: #D8DEE9FF">FETCH NEXT </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> userCursor </span><span style="color: #81A1C1">INTO</span><span style="color: #D8DEE9FF"> @userId</span>
<span style="color: #D8DEE9FF">WHILE @@FETCH_STATUS </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">0</span>
<span style="color: #81A1C1">BEGIN</span>
<span style="color: #ECEFF4">    </span><span style="color: #4C566A">-- Get property value start/end indexes from PropertyNames</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @propertyNames </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> NVARCHAR(max)</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @propertyNames </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #81A1C1">SELECT</span><span style="color: #D8DEE9FF"> PropertyNames </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> aspnet_Profile </span><span style="color: #81A1C1">WHERE</span><span style="color: #D8DEE9FF"> UserId </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @userId)</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @username </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #81A1C1">SELECT</span><span style="color: #D8DEE9FF"> UserName </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> aspnet_Users </span><span style="color: #81A1C1">WHERE</span><span style="color: #D8DEE9FF"> UserId </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @userId)</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @startIndex </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF">, @endIndex </span><span style="color: #81A1C1">as</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @startIndex </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (CHARINDEX(@propertyKey </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:S:</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF">, @propertyNames)) </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> LEN(@propertyKey </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:S:</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF">)</span>
<span style="color: #D8DEE9FF">    </span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @pos </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF">, @count </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @count </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">0</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @pos </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @startIndex</span>
<span style="color: #D8DEE9FF">    </span>
<span style="color: #D8DEE9FF">    WHILE(@count </span><span style="color: #81A1C1">!=</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">2</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">AND</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyNames, @pos, </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">) </span><span style="color: #81A1C1">!=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">''</span><span style="color: #D8DEE9FF">)</span>
<span style="color: #D8DEE9FF">		</span><span style="color: #81A1C1">BEGIN</span>
<span style="color: #D8DEE9FF">		IF </span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyNames, @pos, </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">) </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:</span><span style="color: #ECEFF4">'</span>
<span style="color: #D8DEE9FF">			</span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @count </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @count </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span>
<span style="color: #D8DEE9FF">		</span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @pos </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @pos </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span>
<span style="color: #D8DEE9FF">		END</span>
<span style="color: #D8DEE9FF">    </span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @propertyNames </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyNames, @startIndex, (@pos </span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF"> @startIndex </span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">)))</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @startIndex </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyNames, </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">, (CHARINDEX(</span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF">, @propertyNames) </span><span style="color: #81A1C1">-</span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">)))</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @endIndex </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyNames, (CHARINDEX(</span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF">, @propertyNames)  </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">), (LEN(@propertyNames) </span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF"> CHARINDEX(</span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">:</span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF">, @propertyNames))))</span>
<span style="color: #D8DEE9FF">    </span>
<span style="color: #ECEFF4">    </span><span style="color: #4C566A">-- Verify PropertyValue for IsAdministrator profile key is 'True'</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">DECLARE</span><span style="color: #D8DEE9FF"> @propertyStrings </span><span style="color: #81A1C1">AS</span><span style="color: #D8DEE9FF"> nvarchar(MAX)</span>
<span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">SET</span><span style="color: #D8DEE9FF"> @propertyStrings </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> (</span><span style="color: #81A1C1">SELECT</span><span style="color: #D8DEE9FF"> PropertyValuesString </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> aspnet_Profile </span><span style="color: #81A1C1">WHERE</span><span style="color: #D8DEE9FF"> UserId </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @userId)</span>
<span style="color: #D8DEE9FF">	</span>
<span style="color: #D8DEE9FF">	IF @expectedValue </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">''</span>
<span style="color: #D8DEE9FF">		</span><span style="color: #81A1C1">BEGIN</span>
<span style="color: #D8DEE9FF">			print @username </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">'</span><span style="color: #A3BE8C">, </span><span style="color: #ECEFF4">'</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> (</span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyStrings, @startIndex </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">, @endIndex))</span>
<span style="color: #D8DEE9FF">		END</span>
<span style="color: #D8DEE9FF">	ELSE</span>
<span style="color: #D8DEE9FF">		</span><span style="color: #81A1C1">BEGIN</span>
<span style="color: #D8DEE9FF">			IF </span><span style="color: #88C0D0">SUBSTRING</span><span style="color: #D8DEE9FF">(@propertyStrings, @startIndex, @endIndex </span><span style="color: #81A1C1">+</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">1</span><span style="color: #D8DEE9FF">) </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> @expectedValue</span>
<span style="color: #D8DEE9FF">				</span><span style="color: #81A1C1">BEGIN</span>
<span style="color: #D8DEE9FF">				print @username   </span>
<span style="color: #D8DEE9FF">			END</span>
<span style="color: #D8DEE9FF">		END</span>
<span style="color: #D8DEE9FF">		</span>
<span style="color: #D8DEE9FF">    FETCH NEXT </span><span style="color: #81A1C1">FROM</span><span style="color: #D8DEE9FF"> userCursor </span><span style="color: #81A1C1">INTO</span><span style="color: #D8DEE9FF"> @userId</span>
<span style="color: #D8DEE9FF">END</span>
<span style="color: #D8DEE9FF">CLOSE userCursor</span>
<span style="color: #D8DEE9FF">DEALLOCATE userCursor</span></code></pre>
</div><!----><div class="mb-8 pt-2 border-t-3 border-double border-gray-600"><a href="/" class="font-bold uppercase active">Back to Blog</a></div></article></div></div><footer class="bg-brand-900 text-white"><div id="contact" class="container mx-auto flex flex-col items-center py-8"><div class="mb-3"><a href="/tag" class="text-white hover:text-white flex font-normal hover:underline"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="pl-2">Browse posts by tag</span></a></div><ul class="flex items-center space-x-8 mb-3"><li><a href="/rss.xml" aria-label="RSS" class="rounded-full bg-opacity-80 block bg-gray-800 p-2 text-white hover:text-gray-400 font-normal"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></li><li><a href="https://github.com/chowson" aria-label="Github" target="_blank" rel="noreferrer" class="rounded-full bg-opacity-80 block bg-gray-800 p-2 text-white hover:text-gray-400"><svg width="24" height="23" viewBox="0 0 20 19" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M10 0c1.814 0 3.487.435 5.02 1.306a9.827 9.827 0 0 1 3.639 3.542A9.33 9.33 0 0 1 20 9.734c0 2.121-.636 4.03-1.908 5.723a9.783 9.783 0 0 1-4.928 3.518c-.234.042-.408.012-.52-.09a.49.49 0 0 1-.17-.38l.006-.969c.005-.621.007-1.19.007-1.705 0-.82-.226-1.42-.677-1.8.495-.05.94-.126 1.335-.228a5.4 5.4 0 0 0 1.223-.494 3.62 3.62 0 0 0 1.055-.843c.282-.334.512-.777.69-1.33.178-.554.267-1.19.267-1.909a3.7 3.7 0 0 0-1.028-2.61c.32-.77.286-1.631-.105-2.586-.243-.076-.594-.03-1.054.14-.46.168-.86.354-1.198.557l-.495.304a9.478 9.478 0 0 0-2.5-.33c-.86 0-1.693.11-2.5.33a11.6 11.6 0 0 0-.553-.342c-.23-.135-.593-.298-1.088-.488-.494-.19-.863-.247-1.106-.171-.391.955-.426 1.816-.105 2.585A3.7 3.7 0 0 0 3.62 9.227c0 .719.089 1.352.267 1.902.178.549.406.993.683 1.33.278.339.627.622 1.048.85a5.4 5.4 0 0 0 1.224.494c.395.102.84.178 1.335.228-.338.305-.551.74-.638 1.306a2.631 2.631 0 0 1-.586.19 3.782 3.782 0 0 1-.742.063c-.287 0-.57-.09-.853-.272a2.256 2.256 0 0 1-.723-.792 2.068 2.068 0 0 0-.631-.66c-.256-.168-.471-.27-.645-.304l-.26-.038c-.182 0-.308.02-.378.057-.07.038-.09.087-.065.146.026.06.065.118.117.178.053.059.109.11.17.152l.09.063c.192.085.38.245.567.482.187.236.324.452.41.646l.13.292c.113.32.304.58.574.78.269.198.56.325.872.38.312.054.614.084.905.088.29.004.532-.01.723-.044l.299-.05c0 .32.002.694.007 1.12l.006.692a.49.49 0 0 1-.17.38c-.112.101-.286.13-.52.089a9.783 9.783 0 0 1-4.928-3.518C.636 13.763 0 11.855 0 9.734a9.33 9.33 0 0 1 1.341-4.886 9.827 9.827 0 0 1 3.64-3.542C6.512.436 8.185 0 10 0zM3.79 13.98c.025-.058-.005-.11-.092-.151-.087-.026-.143-.017-.17.025-.025.06.005.11.092.152.078.05.134.042.17-.025zm.403.432c.06-.043.052-.11-.026-.203-.087-.076-.157-.089-.209-.038-.06.042-.052.11.026.203.087.084.157.097.209.038zm.39.57c.078-.06.078-.14 0-.24-.07-.11-.143-.136-.221-.077-.078.042-.078.118 0 .228.078.11.152.14.221.089zm.547.532c.07-.067.052-.148-.052-.24-.104-.102-.19-.115-.26-.039-.078.068-.061.148.052.241.104.102.19.114.26.038zm.742.317c.026-.093-.03-.16-.169-.203-.13-.033-.213-.004-.247.09-.035.092.021.155.169.19.13.05.213.025.247-.077zm.82.064c0-.11-.073-.157-.22-.14-.14 0-.209.047-.209.14 0 .11.074.156.221.139.14 0 .209-.046.209-.14zm.756-.127c-.017-.093-.096-.131-.234-.114-.14.025-.2.088-.183.19.018.101.096.135.235.101.139-.034.2-.093.182-.177z" fill-rule="nonzero"></path></svg></a></li></ul><div>Copyright chowson.github.io 2020</div></div></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Find Sitecore users with profile setting","description":"Find Sitecore users with profile setting","date":"July 28, 2015","timeToRead":2,"content":"\u003Cp\u003EThrough the role manager, you can easily find which users are in a particular role but you can't easily\nget a list of users which are an administrator. This is because the administrator setting is stored as a\nprofile value on the user. To generate a list of administrators run the following script against your\n\u003Cem\u003Ecore\u003C\u002Fem\u003E database.\u003C\u002Fp\u003E\n\u003Cp\u003EYou can also modify the script to find users with the existence of any profile key and optionally users which have a profile key that matches a particular  value. To do this you will need to modify the \u003Cem\u003E@propertyKey\u003C\u002Fem\u003E and \u003Cem\u003E@expectedValue\u003C\u002Fem\u003E variables at the top of the script. Leaving \u003Cem\u003E@expectedValue\u003C\u002Fem\u003E as an empty string will return users which have the existence of a profile key rather than trying to match it to a value.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #2e3440\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyKey \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E nvarchar(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E50\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E), @expectedValue \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E nvarchar(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E255\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #4C566A\"\u003E--SET PROPERTY KEY AND EXPECTED VALUE HERE\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyKey \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003EIsAdministrator\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @expectedValue \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003ETrue\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\n\n\n\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E uniqueidentifier\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @username \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E nvarchar(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E255\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E userCursor CURSOR \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E  LOCAL STATIC READ_ONLY FORWARD_ONLY\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EFOR \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #81A1C1\"\u003ESELECT DISTINCT\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E UserId \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E aspnet_Profile \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EWHERE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E PropertyNames \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ELIKE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E%\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyKey \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E%\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EOPEN userCursor\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EFETCH NEXT \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E userCursor \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EINTO\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EWHILE @@FETCH_STATUS \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E0\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #81A1C1\"\u003EBEGIN\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #ECEFF4\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #4C566A\"\u003E-- Get property value start\u002Fend indexes from PropertyNames\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyNames \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E NVARCHAR(max)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyNames \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESELECT\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E PropertyNames \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E aspnet_Profile \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EWHERE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E UserId \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @username \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESELECT\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E UserName \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E aspnet_Users \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EWHERE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E UserId \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @startIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @endIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003Eas\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003Eint\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @startIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (CHARINDEX(@propertyKey \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:S:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @propertyNames)) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E LEN(@propertyKey \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:S:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @pos \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @count \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003Eint\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @count \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E0\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @pos \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @startIndex\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    WHILE(@count \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E!=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E2\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAND\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyNames, @pos, \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E!=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E''\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EBEGIN\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\tIF \u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyNames, @pos, \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @count \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @count \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @pos \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @pos \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\tEND\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyNames \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyNames, @startIndex, (@pos \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E-\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @startIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E-\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)))\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @startIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyNames, \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, (CHARINDEX(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @propertyNames) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E-\u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E)))\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @endIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyNames, (CHARINDEX(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @propertyNames)  \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E), (LEN(@propertyNames) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E-\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E CHARINDEX(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @propertyNames))))\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #ECEFF4\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #4C566A\"\u003E-- Verify PropertyValue for IsAdministrator profile key is 'True'\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EDECLARE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyStrings \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EAS\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E nvarchar(MAX)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESET\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @propertyStrings \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003ESELECT\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E PropertyValuesString \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E aspnet_Profile \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EWHERE\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E UserId \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\tIF @expectedValue \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E''\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EBEGIN\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\tprint @username \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #A3BE8C\"\u003E, \u003C\u002Fspan\u003E\u003Cspan style=\"color: #ECEFF4\"\u003E'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyStrings, @startIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E, @endIndex))\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\tEND\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\tELSE\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EBEGIN\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\tIF \u003C\u002Fspan\u003E\u003Cspan style=\"color: #88C0D0\"\u003ESUBSTRING\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E(@propertyStrings, @startIndex, @endIndex \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E+\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #B48EAD\"\u003E1\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @expectedValue\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\t\t\u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EBEGIN\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\t\tprint @username   \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\tEND\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\tEND\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E\t\t\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003E    FETCH NEXT \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EFROM\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E userCursor \u003C\u002Fspan\u003E\u003Cspan style=\"color: #81A1C1\"\u003EINTO\u003C\u002Fspan\u003E\u003Cspan style=\"color: #D8DEE9FF\"\u003E @userId\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EEND\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003ECLOSE userCursor\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #D8DEE9FF\"\u003EDEALLOCATE userCursor\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n","tags":[{"title":"sitecore","path":"\u002Ftag\u002Fsitecore\u002F"},{"title":"sql","path":"\u002Ftag\u002Fsql\u002F"},{"title":"debugging","path":"\u002Ftag\u002Fdebugging\u002F"}],"references":[],"path":"\u002Ffind-sitecore-users-with-profile-setting\u002F"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.575a9b0d.js" defer></script><script src="/assets/js/page--src--templates--post-vue.d0e54b0c.js" defer></script>
  </body>
</html>